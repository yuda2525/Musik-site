<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Musik + Equalizer</title>
  <style>
    body {
      background: #121212;
      color: white;
      text-align: center;
      font-family: Arial, sans-serif;
      padding: 50px;
    }

    #muteToggle {
      font-size: 24px;
      padding: 10px 25px;
      margin-top: 20px;
      border: none;
      border-radius: 8px;
      background-color: #1db954;
      color: white;
      cursor: pointer;
    }

    #muteToggle:hover {
      background-color: #159b40;
    }
  </style>
</head>
<body>

  <h1>ðŸŽ¶ Musik & Equalizer ðŸŽ¶</h1>
  <p>Autoplay musik dengan volume seimbang dan tombol mute/unmute</p>

  <video id="bgmusic" autoplay loop muted style="display:none">
    <source src="https://github.com/yuda2525/YZ-site/blob/main/Yiruma%2C%20(%EC%9D%B4%EB%A3%A8%EB%A7%88)%20-%20Kiss%20the%20Rain.m4a" type="video/mp4">
    Browser kamu tidak mendukung video.
  </video>

  <button id="muteToggle">ðŸ”‡</button>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const bgmusic = document.getElementById("bgmusic");
      const muteBtn = document.getElementById("muteToggle");

      // Web Audio API context
      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

      // Hubungkan elemen video ke AudioContext
      const source = audioCtx.createMediaElementSource(bgmusic);

      // Buat EQ filter (contoh: lowShelf boost)
      const eqFilter = audioCtx.createBiquadFilter();
      eqFilter.type = "lowshelf";
      eqFilter.frequency.setValueAtTime(200, audioCtx.currentTime); // 200 Hz
      eqFilter.gain.setValueAtTime(6, audioCtx.currentTime); // Boost bass 6dB

      // Gain node (volume control)
      const gainNode = audioCtx.createGain();
      gainNode.gain.value = 0.3; // volume awal 30%

      // Routing: source â†’ EQ â†’ Gain â†’ destination
      source.connect(eqFilter);
      eqFilter.connect(gainNode);
      gainNode.connect(audioCtx.destination);

      // Mulai musik dengan unmute delay
      setTimeout(() => {
        bgmusic.muted = false;
        bgmusic.volume = 1.0; // volume elemen max, dikontrol via gain
      }, 500);

      // Mute toggle
      muteBtn.addEventListener("click", () => {
        if (gainNode.gain.value > 0) {
          gainNode.gain.value = 0;
          muteBtn.textContent = "ðŸ”‡";
        } else {
          gainNode.gain.value = 0.3;
          muteBtn.textContent = "ðŸ”Š";
        }
      });

      // Auto resume audio context on interaction (iOS/Chrome block fix)
      window.addEventListener("click", () => {
        if (audioCtx.state === "suspended") {
          audioCtx.resume();
        }
      });
    });
  </script>

</body>
</html>
